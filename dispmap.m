function dispmap( table, attribute )
%DISPMAP shows the map of different attributes

if nargin == 1
    
    maxdose = max(table.dose);
    
    %adjust the data in the table to display each ID for use with
    %different color channels
    table.dose = table.dose + ( maxdose * table.ID );
    
    %convert table to matrix for display purposes
    mat = table2mat(table,'dose');
    
    %display dosemap
    h = figure;
    
    %add pause button
    uicontrol(...%'Style','togglebutton',...
        'Position',[10 100 50 50],...
        'String','Pause',...
        'Callback','uiwait(gcbf)');
    %add resume button
    uicontrol('Position',[10 30 50 50],...
        'String','Resume',...
        'Callback','uiresume(gcbf)');
    
    %create colormap, which is a sequence of concatenated colormaps with 64
    %row entries defining the gradient from black to the given color)
    cmap = [0,0,0;0.0158730167895556,0.0158730167895556,0.0158730167895556;0.0317460335791111,0.0317460335791111,0.0317460335791111;0.0476190485060215,0.0476190485060215,0.0476190485060215;0.0634920671582222,0.0634920671582222,0.0634920671582222;0.0793650820851326,0.0793650820851326,0.0793650820851326;0.0952380970120430,0.0952380970120430,0.0952380970120430;0.111111111938953,0.111111111938953,0.111111111938953;0.126984134316444,0.126984134316444,0.126984134316444;0.142857149243355,0.142857149243355,0.142857149243355;0.158730164170265,0.158730164170265,0.158730164170265;0.174603179097176,0.174603179097176,0.174603179097176;0.190476194024086,0.190476194024086,0.190476194024086;0.206349208950996,0.206349208950996,0.206349208950996;0.222222223877907,0.222222223877907,0.222222223877907;0.238095238804817,0.238095238804817,0.238095238804817;0.253968268632889,0.253968268632889,0.253968268632889;0.269841283559799,0.269841283559799,0.269841283559799;0.285714298486710,0.285714298486710,0.285714298486710;0.301587313413620,0.301587313413620,0.301587313413620;0.317460328340530,0.317460328340530,0.317460328340530;0.333333343267441,0.333333343267441,0.333333343267441;0.349206358194351,0.349206358194351,0.349206358194351;0.365079373121262,0.365079373121262,0.365079373121262;0.380952388048172,0.380952388048172,0.380952388048172;0.396825402975082,0.396825402975082,0.396825402975082;0.412698417901993,0.412698417901993,0.412698417901993;0.428571432828903,0.428571432828903,0.428571432828903;0.444444447755814,0.444444447755814,0.444444447755814;0.460317462682724,0.460317462682724,0.460317462682724;0.476190477609634,0.476190477609634,0.476190477609634;0.492063492536545,0.492063492536545,0.492063492536545;0.507936537265778,0.507936537265778,0.507936537265778;0.523809552192688,0.523809552192688,0.523809552192688;0.539682567119598,0.539682567119598,0.539682567119598;0.555555582046509,0.555555582046509,0.555555582046509;0.571428596973419,0.571428596973419,0.571428596973419;0.587301611900330,0.587301611900330,0.587301611900330;0.603174626827240,0.603174626827240,0.603174626827240;0.619047641754150,0.619047641754150,0.619047641754150;0.634920656681061,0.634920656681061,0.634920656681061;0.650793671607971,0.650793671607971,0.650793671607971;0.666666686534882,0.666666686534882,0.666666686534882;0.682539701461792,0.682539701461792,0.682539701461792;0.698412716388702,0.698412716388702,0.698412716388702;0.714285731315613,0.714285731315613,0.714285731315613;0.730158746242523,0.730158746242523,0.730158746242523;0.746031761169434,0.746031761169434,0.746031761169434;0.761904776096344,0.761904776096344,0.761904776096344;0.777777791023254,0.777777791023254,0.777777791023254;0.793650805950165,0.793650805950165,0.793650805950165;0.809523820877075,0.809523820877075,0.809523820877075;0.825396835803986,0.825396835803986,0.825396835803986;0.841269850730896,0.841269850730896,0.841269850730896;0.857142865657806,0.857142865657806,0.857142865657806;0.873015880584717,0.873015880584717,0.873015880584717;0.888888895511627,0.888888895511627,0.888888895511627;0.904761910438538,0.904761910438538,0.904761910438538;0.920634925365448,0.920634925365448,0.920634925365448;0.936507940292358,0.936507940292358,0.936507940292358;0.952380955219269,0.952380955219269,0.952380955219269;0.968253970146179,0.968253970146179,0.968253970146179;0.984126985073090,0.984126985073090,0.984126985073090;1,1,1;0,0,0;0.0158730167895556,0,0;0.0317460335791111,0,0;0.0476190485060215,0,0;0.0634920671582222,0,0;0.0793650820851326,0,0;0.0952380970120430,0,0;0.111111111938953,0,0;0.126984134316444,0,0;0.142857149243355,0,0;0.158730164170265,0,0;0.174603179097176,0,0;0.190476194024086,0,0;0.206349208950996,0,0;0.222222223877907,0,0;0.238095238804817,0,0;0.253968268632889,0,0;0.269841283559799,0,0;0.285714298486710,0,0;0.301587313413620,0,0;0.317460328340530,0,0;0.333333343267441,0,0;0.349206358194351,0,0;0.365079373121262,0,0;0.380952388048172,0,0;0.396825402975082,0,0;0.412698417901993,0,0;0.428571432828903,0,0;0.444444447755814,0,0;0.460317462682724,0,0;0.476190477609634,0,0;0.492063492536545,0,0;0.507936537265778,0,0;0.523809552192688,0,0;0.539682567119598,0,0;0.555555582046509,0,0;0.571428596973419,0,0;0.587301611900330,0,0;0.603174626827240,0,0;0.619047641754150,0,0;0.634920656681061,0,0;0.650793671607971,0,0;0.666666686534882,0,0;0.682539701461792,0,0;0.698412716388702,0,0;0.714285731315613,0,0;0.730158746242523,0,0;0.746031761169434,0,0;0.761904776096344,0,0;0.777777791023254,0,0;0.793650805950165,0,0;0.809523820877075,0,0;0.825396835803986,0,0;0.841269850730896,0,0;0.857142865657806,0,0;0.873015880584717,0,0;0.888888895511627,0,0;0.904761910438538,0,0;0.920634925365448,0,0;0.936507940292358,0,0;0.952380955219269,0,0;0.968253970146179,0,0;0.984126985073090,0,0;1,0,0;0,0,0;0,0.0158730167895556,0;0,0.0317460335791111,0;0,0.0476190485060215,0;0,0.0634920671582222,0;0,0.0793650820851326,0;0,0.0952380970120430,0;0,0.111111111938953,0;0,0.126984134316444,0;0,0.142857149243355,0;0,0.158730164170265,0;0,0.174603179097176,0;0,0.190476194024086,0;0,0.206349208950996,0;0,0.222222223877907,0;0,0.238095238804817,0;0,0.253968268632889,0;0,0.269841283559799,0;0,0.285714298486710,0;0,0.301587313413620,0;0,0.317460328340530,0;0,0.333333343267441,0;0,0.349206358194351,0;0,0.365079373121262,0;0,0.380952388048172,0;0,0.396825402975082,0;0,0.412698417901993,0;0,0.428571432828903,0;0,0.444444447755814,0;0,0.460317462682724,0;0,0.476190477609634,0;0,0.492063492536545,0;0,0.507936537265778,0;0,0.523809552192688,0;0,0.539682567119598,0;0,0.555555582046509,0;0,0.571428596973419,0;0,0.587301611900330,0;0,0.603174626827240,0;0,0.619047641754150,0;0,0.634920656681061,0;0,0.650793671607971,0;0,0.666666686534882,0;0,0.682539701461792,0;0,0.698412716388702,0;0,0.714285731315613,0;0,0.730158746242523,0;0,0.746031761169434,0;0,0.761904776096344,0;0,0.777777791023254,0;0,0.793650805950165,0;0,0.809523820877075,0;0,0.825396835803986,0;0,0.841269850730896,0;0,0.857142865657806,0;0,0.873015880584717,0;0,0.888888895511627,0;0,0.904761910438538,0;0,0.920634925365448,0;0,0.936507940292358,0;0,0.952380955219269,0;0,0.968253970146179,0;0,0.984126985073090,0;0,1,0;0,0,0;0,0,0.0158730167895556;0,0,0.0317460335791111;0,0,0.0476190485060215;0,0,0.0634920671582222;0,0,0.0793650820851326;0,0,0.0952380970120430;0,0,0.111111111938953;0,0,0.126984134316444;0,0,0.142857149243355;0,0,0.158730164170265;0,0,0.174603179097176;0,0,0.190476194024086;0,0,0.206349208950996;0,0,0.222222223877907;0,0,0.238095238804817;0,0,0.253968268632889;0,0,0.269841283559799;0,0,0.285714298486710;0,0,0.301587313413620;0,0,0.317460328340530;0,0,0.333333343267441;0,0,0.349206358194351;0,0,0.365079373121262;0,0,0.380952388048172;0,0,0.396825402975082;0,0,0.412698417901993;0,0,0.428571432828903;0,0,0.444444447755814;0,0,0.460317462682724;0,0,0.476190477609634;0,0,0.492063492536545;0,0,0.507936537265778;0,0,0.523809552192688;0,0,0.539682567119598;0,0,0.555555582046509;0,0,0.571428596973419;0,0,0.587301611900330;0,0,0.603174626827240;0,0,0.619047641754150;0,0,0.634920656681061;0,0,0.650793671607971;0,0,0.666666686534882;0,0,0.682539701461792;0,0,0.698412716388702;0,0,0.714285731315613;0,0,0.730158746242523;0,0,0.746031761169434;0,0,0.761904776096344;0,0,0.777777791023254;0,0,0.793650805950165;0,0,0.809523820877075;0,0,0.825396835803986;0,0,0.841269850730896;0,0,0.857142865657806;0,0,0.873015880584717;0,0,0.888888895511627;0,0,0.904761910438538;0,0,0.920634925365448;0,0,0.936507940292358;0,0,0.952380955219269;0,0,0.968253970146179;0,0,0.984126985073090;0,0,1;0,0,0;0.0158730167895556,0.00790538452565670,0;0.0317460335791111,0.0158107690513134,0;0.0476190485060215,0.0237161535769701,0;0.0634920671582222,0.0316215381026268,0;0.0793650820851326,0.0395269207656384,0;0.0952380970120430,0.0474323071539402,0;0.111111111938953,0.0553376898169518,0;0.126984134316444,0.0632430762052536,0;0.142857149243355,0.0711484625935555,0;0.158730164170265,0.0790538415312767,0;0.174603179097176,0.0869592279195786,0;0.190476194024086,0.0948646143078804,0;0.206349208950996,0.102769993245602,0;0.222222223877907,0.110675379633904,0;0.238095238804817,0.118580766022205,0;0.253968268632889,0.126486152410507,0;0.269841283559799,0.134391531348228,0;0.285714298486710,0.142296925187111,0;0.301587313413620,0.150202304124832,0;0.317460328340530,0.158107683062553,0;0.333333343267441,0.166013076901436,0;0.349206358194351,0.173918455839157,0;0.365079373121262,0.181823834776878,0;0.380952388048172,0.189729228615761,0;0.396825402975082,0.197634607553482,0;0.412698417901993,0.205539986491203,0;0.428571432828903,0.213445380330086,0;0.444444447755814,0.221350759267807,0;0.460317462682724,0.229256153106689,0;0.476190477609634,0.237161532044411,0;0.492063492536545,0.245066910982132,0;0.507936537265778,0.252972304821014,0;0.523809552192688,0.260877698659897,0;0.539682567119598,0.268783062696457,0;0.555555582046509,0.276688456535339,0;0.571428596973419,0.284593850374222,0;0.587301611900330,0.292499214410782,0;0.603174626827240,0.300404608249664,0;0.619047641754150,0.308310002088547,0;0.634920656681061,0.316215366125107,0;0.650793671607971,0.324120759963989,0;0.666666686534882,0.332026153802872,0;0.682539701461792,0.339931517839432,0;0.698412716388702,0.347836911678314,0;0.714285731315613,0.355742305517197,0;0.730158746242523,0.363647669553757,0;0.746031761169434,0.371553063392639,0;0.761904776096344,0.379458457231522,0;0.777777791023254,0.387363821268082,0;0.793650805950165,0.395269215106964,0;0.809523820877075,0.403174608945847,0;0.825396835803986,0.411079972982407,0;0.841269850730896,0.418985366821289,0;0.857142865657806,0.426890760660172,0;0.873015880584717,0.434796154499054,0;0.888888895511627,0.442701518535614,0;0.904761910438538,0.450606912374496,0;0.920634925365448,0.458512306213379,0;0.936507940292358,0.466417670249939,0;0.952380955219269,0.474323064088821,0;0.968253970146179,0.482228457927704,0;0.984126985073090,0.490133821964264,0;1,0.498039215803146,0;0,0,0;0,0.0158730167895556,0.00790538452565670;0,0.0317460335791111,0.0158107690513134;0,0.0476190485060215,0.0237161535769701;0,0.0634920671582222,0.0316215381026268;0,0.0793650820851326,0.0395269207656384;0,0.0952380970120430,0.0474323071539402;0,0.111111111938953,0.0553376898169518;0,0.126984134316444,0.0632430762052536;0,0.142857149243355,0.0711484625935555;0,0.158730164170265,0.0790538415312767;0,0.174603179097176,0.0869592279195786;0,0.190476194024086,0.0948646143078804;0,0.206349208950996,0.102769993245602;0,0.222222223877907,0.110675379633904;0,0.238095238804817,0.118580766022205;0,0.253968268632889,0.126486152410507;0,0.269841283559799,0.134391531348228;0,0.285714298486710,0.142296925187111;0,0.301587313413620,0.150202304124832;0,0.317460328340530,0.158107683062553;0,0.333333343267441,0.166013076901436;0,0.349206358194351,0.173918455839157;0,0.365079373121262,0.181823834776878;0,0.380952388048172,0.189729228615761;0,0.396825402975082,0.197634607553482;0,0.412698417901993,0.205539986491203;0,0.428571432828903,0.213445380330086;0,0.444444447755814,0.221350759267807;0,0.460317462682724,0.229256153106689;0,0.476190477609634,0.237161532044411;0,0.492063492536545,0.245066910982132;0,0.507936537265778,0.252972304821014;0,0.523809552192688,0.260877698659897;0,0.539682567119598,0.268783062696457;0,0.555555582046509,0.276688456535339;0,0.571428596973419,0.284593850374222;0,0.587301611900330,0.292499214410782;0,0.603174626827240,0.300404608249664;0,0.619047641754150,0.308310002088547;0,0.634920656681061,0.316215366125107;0,0.650793671607971,0.324120759963989;0,0.666666686534882,0.332026153802872;0,0.682539701461792,0.339931517839432;0,0.698412716388702,0.347836911678314;0,0.714285731315613,0.355742305517197;0,0.730158746242523,0.363647669553757;0,0.746031761169434,0.371553063392639;0,0.761904776096344,0.379458457231522;0,0.777777791023254,0.387363821268082;0,0.793650805950165,0.395269215106964;0,0.809523820877075,0.403174608945847;0,0.825396835803986,0.411079972982407;0,0.841269850730896,0.418985366821289;0,0.857142865657806,0.426890760660172;0,0.873015880584717,0.434796154499054;0,0.888888895511627,0.442701518535614;0,0.904761910438538,0.450606912374496;0,0.920634925365448,0.458512306213379;0,0.936507940292358,0.466417670249939;0,0.952380955219269,0.474323064088821;0,0.968253970146179,0.482228457927704;0,0.984126985073090,0.490133821964264;0,1,0.498039215803146;0,0,0;0.00790538452565670,0,0.0158730167895556;0.0158107690513134,0,0.0317460335791111;0.0237161535769701,0,0.0476190485060215;0.0316215381026268,0,0.0634920671582222;0.0395269207656384,0,0.0793650820851326;0.0474323071539402,0,0.0952380970120430;0.0553376898169518,0,0.111111111938953;0.0632430762052536,0,0.126984134316444;0.0711484625935555,0,0.142857149243355;0.0790538415312767,0,0.158730164170265;0.0869592279195786,0,0.174603179097176;0.0948646143078804,0,0.190476194024086;0.102769993245602,0,0.206349208950996;0.110675379633904,0,0.222222223877907;0.118580766022205,0,0.238095238804817;0.126486152410507,0,0.253968268632889;0.134391531348228,0,0.269841283559799;0.142296925187111,0,0.285714298486710;0.150202304124832,0,0.301587313413620;0.158107683062553,0,0.317460328340530;0.166013076901436,0,0.333333343267441;0.173918455839157,0,0.349206358194351;0.181823834776878,0,0.365079373121262;0.189729228615761,0,0.380952388048172;0.197634607553482,0,0.396825402975082;0.205539986491203,0,0.412698417901993;0.213445380330086,0,0.428571432828903;0.221350759267807,0,0.444444447755814;0.229256153106689,0,0.460317462682724;0.237161532044411,0,0.476190477609634;0.245066910982132,0,0.492063492536545;0.252972304821014,0,0.507936537265778;0.260877698659897,0,0.523809552192688;0.268783062696457,0,0.539682567119598;0.276688456535339,0,0.555555582046509;0.284593850374222,0,0.571428596973419;0.292499214410782,0,0.587301611900330;0.300404608249664,0,0.603174626827240;0.308310002088547,0,0.619047641754150;0.316215366125107,0,0.634920656681061;0.324120759963989,0,0.650793671607971;0.332026153802872,0,0.666666686534882;0.339931517839432,0,0.682539701461792;0.347836911678314,0,0.698412716388702;0.355742305517197,0,0.714285731315613;0.363647669553757,0,0.730158746242523;0.371553063392639,0,0.746031761169434;0.379458457231522,0,0.761904776096344;0.387363821268082,0,0.777777791023254;0.395269215106964,0,0.793650805950165;0.403174608945847,0,0.809523820877075;0.411079972982407,0,0.825396835803986;0.418985366821289,0,0.841269850730896;0.426890760660172,0,0.857142865657806;0.434796154499054,0,0.873015880584717;0.442701518535614,0,0.888888895511627;0.450606912374496,0,0.904761910438538;0.458512306213379,0,0.920634925365448;0.466417670249939,0,0.936507940292358;0.474323064088821,0,0.952380955219269;0.482228457927704,0,0.968253970146179;0.490133821964264,0,0.984126985073090;0.498039215803146,0,1;0,0,0;0.0158730167895556,0.0158730167895556,0;0.0317460335791111,0.0317460335791111,0;0.0476190485060215,0.0476190485060215,0;0.0634920671582222,0.0634920671582222,0;0.0793650820851326,0.0793650820851326,0;0.0952380970120430,0.0952380970120430,0;0.111111111938953,0.111111111938953,0;0.126984134316444,0.126984134316444,0;0.142857149243355,0.142857149243355,0;0.158730164170265,0.158730164170265,0;0.174603179097176,0.174603179097176,0;0.190476194024086,0.190476194024086,0;0.206349208950996,0.206349208950996,0;0.222222223877907,0.222222223877907,0;0.238095238804817,0.238095238804817,0;0.253968268632889,0.253968268632889,0;0.269841283559799,0.269841283559799,0;0.285714298486710,0.285714298486710,0;0.301587313413620,0.301587313413620,0;0.317460328340530,0.317460328340530,0;0.333333343267441,0.333333343267441,0;0.349206358194351,0.349206358194351,0;0.365079373121262,0.365079373121262,0;0.380952388048172,0.380952388048172,0;0.396825402975082,0.396825402975082,0;0.412698417901993,0.412698417901993,0;0.428571432828903,0.428571432828903,0;0.444444447755814,0.444444447755814,0;0.460317462682724,0.460317462682724,0;0.476190477609634,0.476190477609634,0;0.492063492536545,0.492063492536545,0;0.507936537265778,0.507936537265778,0;0.523809552192688,0.523809552192688,0;0.539682567119598,0.539682567119598,0;0.555555582046509,0.555555582046509,0;0.571428596973419,0.571428596973419,0;0.587301611900330,0.587301611900330,0;0.603174626827240,0.603174626827240,0;0.619047641754150,0.619047641754150,0;0.634920656681061,0.634920656681061,0;0.650793671607971,0.650793671607971,0;0.666666686534882,0.666666686534882,0;0.682539701461792,0.682539701461792,0;0.698412716388702,0.698412716388702,0;0.714285731315613,0.714285731315613,0;0.730158746242523,0.730158746242523,0;0.746031761169434,0.746031761169434,0;0.761904776096344,0.761904776096344,0;0.777777791023254,0.777777791023254,0;0.793650805950165,0.793650805950165,0;0.809523820877075,0.809523820877075,0;0.825396835803986,0.825396835803986,0;0.841269850730896,0.841269850730896,0;0.857142865657806,0.857142865657806,0;0.873015880584717,0.873015880584717,0;0.888888895511627,0.888888895511627,0;0.904761910438538,0.904761910438538,0;0.920634925365448,0.920634925365448,0;0.936507940292358,0.936507940292358,0;0.952380955219269,0.952380955219269,0;0.968253970146179,0.968253970146179,0;0.984126985073090,0.984126985073090,0;1,1,0;0,0,0;0,0.0158730167895556,0.0158730167895556;0,0.0317460335791111,0.0317460335791111;0,0.0476190485060215,0.0476190485060215;0,0.0634920671582222,0.0634920671582222;0,0.0793650820851326,0.0793650820851326;0,0.0952380970120430,0.0952380970120430;0,0.111111111938953,0.111111111938953;0,0.126984134316444,0.126984134316444;0,0.142857149243355,0.142857149243355;0,0.158730164170265,0.158730164170265;0,0.174603179097176,0.174603179097176;0,0.190476194024086,0.190476194024086;0,0.206349208950996,0.206349208950996;0,0.222222223877907,0.222222223877907;0,0.238095238804817,0.238095238804817;0,0.253968268632889,0.253968268632889;0,0.269841283559799,0.269841283559799;0,0.285714298486710,0.285714298486710;0,0.301587313413620,0.301587313413620;0,0.317460328340530,0.317460328340530;0,0.333333343267441,0.333333343267441;0,0.349206358194351,0.349206358194351;0,0.365079373121262,0.365079373121262;0,0.380952388048172,0.380952388048172;0,0.396825402975082,0.396825402975082;0,0.412698417901993,0.412698417901993;0,0.428571432828903,0.428571432828903;0,0.444444447755814,0.444444447755814;0,0.460317462682724,0.460317462682724;0,0.476190477609634,0.476190477609634;0,0.492063492536545,0.492063492536545;0,0.507936537265778,0.507936537265778;0,0.523809552192688,0.523809552192688;0,0.539682567119598,0.539682567119598;0,0.555555582046509,0.555555582046509;0,0.571428596973419,0.571428596973419;0,0.587301611900330,0.587301611900330;0,0.603174626827240,0.603174626827240;0,0.619047641754150,0.619047641754150;0,0.634920656681061,0.634920656681061;0,0.650793671607971,0.650793671607971;0,0.666666686534882,0.666666686534882;0,0.682539701461792,0.682539701461792;0,0.698412716388702,0.698412716388702;0,0.714285731315613,0.714285731315613;0,0.730158746242523,0.730158746242523;0,0.746031761169434,0.746031761169434;0,0.761904776096344,0.761904776096344;0,0.777777791023254,0.777777791023254;0,0.793650805950165,0.793650805950165;0,0.809523820877075,0.809523820877075;0,0.825396835803986,0.825396835803986;0,0.841269850730896,0.841269850730896;0,0.857142865657806,0.857142865657806;0,0.873015880584717,0.873015880584717;0,0.888888895511627,0.888888895511627;0,0.904761910438538,0.904761910438538;0,0.920634925365448,0.920634925365448;0,0.936507940292358,0.936507940292358;0,0.952380955219269,0.952380955219269;0,0.968253970146179,0.968253970146179;0,0.984126985073090,0.984126985073090;0,1,1;0,0,0;0.0158730167895556,0,0.0158730167895556;0.0317460335791111,0,0.0317460335791111;0.0476190485060215,0,0.0476190485060215;0.0634920671582222,0,0.0634920671582222;0.0793650820851326,0,0.0793650820851326;0.0952380970120430,0,0.0952380970120430;0.111111111938953,0,0.111111111938953;0.126984134316444,0,0.126984134316444;0.142857149243355,0,0.142857149243355;0.158730164170265,0,0.158730164170265;0.174603179097176,0,0.174603179097176;0.190476194024086,0,0.190476194024086;0.206349208950996,0,0.206349208950996;0.222222223877907,0,0.222222223877907;0.238095238804817,0,0.238095238804817;0.253968268632889,0,0.253968268632889;0.269841283559799,0,0.269841283559799;0.285714298486710,0,0.285714298486710;0.301587313413620,0,0.301587313413620;0.317460328340530,0,0.317460328340530;0.333333343267441,0,0.333333343267441;0.349206358194351,0,0.349206358194351;0.365079373121262,0,0.365079373121262;0.380952388048172,0,0.380952388048172;0.396825402975082,0,0.396825402975082;0.412698417901993,0,0.412698417901993;0.428571432828903,0,0.428571432828903;0.444444447755814,0,0.444444447755814;0.460317462682724,0,0.460317462682724;0.476190477609634,0,0.476190477609634;0.492063492536545,0,0.492063492536545;0.507936537265778,0,0.507936537265778;0.523809552192688,0,0.523809552192688;0.539682567119598,0,0.539682567119598;0.555555582046509,0,0.555555582046509;0.571428596973419,0,0.571428596973419;0.587301611900330,0,0.587301611900330;0.603174626827240,0,0.603174626827240;0.619047641754150,0,0.619047641754150;0.634920656681061,0,0.634920656681061;0.650793671607971,0,0.650793671607971;0.666666686534882,0,0.666666686534882;0.682539701461792,0,0.682539701461792;0.698412716388702,0,0.698412716388702;0.714285731315613,0,0.714285731315613;0.730158746242523,0,0.730158746242523;0.746031761169434,0,0.746031761169434;0.761904776096344,0,0.761904776096344;0.777777791023254,0,0.777777791023254;0.793650805950165,0,0.793650805950165;0.809523820877075,0,0.809523820877075;0.825396835803986,0,0.825396835803986;0.841269850730896,0,0.841269850730896;0.857142865657806,0,0.857142865657806;0.873015880584717,0,0.873015880584717;0.888888895511627,0,0.888888895511627;0.904761910438538,0,0.904761910438538;0.920634925365448,0,0.920634925365448;0.936507940292358,0,0.936507940292358;0.952380955219269,0,0.952380955219269;0.968253970146179,0,0.968253970146179;0.984126985073090,0,0.984126985073090;1,0,1;0,0,0;0.00790538452565670,0.0158730167895556,0;0.0158107690513134,0.0317460335791111,0;0.0237161535769701,0.0476190485060215,0;0.0316215381026268,0.0634920671582222,0;0.0395269207656384,0.0793650820851326,0;0.0474323071539402,0.0952380970120430,0;0.0553376898169518,0.111111111938953,0;0.0632430762052536,0.126984134316444,0;0.0711484625935555,0.142857149243355,0;0.0790538415312767,0.158730164170265,0;0.0869592279195786,0.174603179097176,0;0.0948646143078804,0.190476194024086,0;0.102769993245602,0.206349208950996,0;0.110675379633904,0.222222223877907,0;0.118580766022205,0.238095238804817,0;0.126486152410507,0.253968268632889,0;0.134391531348228,0.269841283559799,0;0.142296925187111,0.285714298486710,0;0.150202304124832,0.301587313413620,0;0.158107683062553,0.317460328340530,0;0.166013076901436,0.333333343267441,0;0.173918455839157,0.349206358194351,0;0.181823834776878,0.365079373121262,0;0.189729228615761,0.380952388048172,0;0.197634607553482,0.396825402975082,0;0.205539986491203,0.412698417901993,0;0.213445380330086,0.428571432828903,0;0.221350759267807,0.444444447755814,0;0.229256153106689,0.460317462682724,0;0.237161532044411,0.476190477609634,0;0.245066910982132,0.492063492536545,0;0.252972304821014,0.507936537265778,0;0.260877698659897,0.523809552192688,0;0.268783062696457,0.539682567119598,0;0.276688456535339,0.555555582046509,0;0.284593850374222,0.571428596973419,0;0.292499214410782,0.587301611900330,0;0.300404608249664,0.603174626827240,0;0.308310002088547,0.619047641754150,0;0.316215366125107,0.634920656681061,0;0.324120759963989,0.650793671607971,0;0.332026153802872,0.666666686534882,0;0.339931517839432,0.682539701461792,0;0.347836911678314,0.698412716388702,0;0.355742305517197,0.714285731315613,0;0.363647669553757,0.730158746242523,0;0.371553063392639,0.746031761169434,0;0.379458457231522,0.761904776096344,0;0.387363821268082,0.777777791023254,0;0.395269215106964,0.793650805950165,0;0.403174608945847,0.809523820877075,0;0.411079972982407,0.825396835803986,0;0.418985366821289,0.841269850730896,0;0.426890760660172,0.857142865657806,0;0.434796154499054,0.873015880584717,0;0.442701518535614,0.888888895511627,0;0.450606912374496,0.904761910438538,0;0.458512306213379,0.920634925365448,0;0.466417670249939,0.936507940292358,0;0.474323064088821,0.952380955219269,0;0.482228457927704,0.968253970146179,0;0.490133821964264,0.984126985073090,0;0.498039215803146,1,0;0,0,0;0,0.00790538452565670,0.0158730167895556;0,0.0158107690513134,0.0317460335791111;0,0.0237161535769701,0.0476190485060215;0,0.0316215381026268,0.0634920671582222;0,0.0395269207656384,0.0793650820851326;0,0.0474323071539402,0.0952380970120430;0,0.0553376898169518,0.111111111938953;0,0.0632430762052536,0.126984134316444;0,0.0711484625935555,0.142857149243355;0,0.0790538415312767,0.158730164170265;0,0.0869592279195786,0.174603179097176;0,0.0948646143078804,0.190476194024086;0,0.102769993245602,0.206349208950996;0,0.110675379633904,0.222222223877907;0,0.118580766022205,0.238095238804817;0,0.126486152410507,0.253968268632889;0,0.134391531348228,0.269841283559799;0,0.142296925187111,0.285714298486710;0,0.150202304124832,0.301587313413620;0,0.158107683062553,0.317460328340530;0,0.166013076901436,0.333333343267441;0,0.173918455839157,0.349206358194351;0,0.181823834776878,0.365079373121262;0,0.189729228615761,0.380952388048172;0,0.197634607553482,0.396825402975082;0,0.205539986491203,0.412698417901993;0,0.213445380330086,0.428571432828903;0,0.221350759267807,0.444444447755814;0,0.229256153106689,0.460317462682724;0,0.237161532044411,0.476190477609634;0,0.245066910982132,0.492063492536545;0,0.252972304821014,0.507936537265778;0,0.260877698659897,0.523809552192688;0,0.268783062696457,0.539682567119598;0,0.276688456535339,0.555555582046509;0,0.284593850374222,0.571428596973419;0,0.292499214410782,0.587301611900330;0,0.300404608249664,0.603174626827240;0,0.308310002088547,0.619047641754150;0,0.316215366125107,0.634920656681061;0,0.324120759963989,0.650793671607971;0,0.332026153802872,0.666666686534882;0,0.339931517839432,0.682539701461792;0,0.347836911678314,0.698412716388702;0,0.355742305517197,0.714285731315613;0,0.363647669553757,0.730158746242523;0,0.371553063392639,0.746031761169434;0,0.379458457231522,0.761904776096344;0,0.387363821268082,0.777777791023254;0,0.395269215106964,0.793650805950165;0,0.403174608945847,0.809523820877075;0,0.411079972982407,0.825396835803986;0,0.418985366821289,0.841269850730896;0,0.426890760660172,0.857142865657806;0,0.434796154499054,0.873015880584717;0,0.442701518535614,0.888888895511627;0,0.450606912374496,0.904761910438538;0,0.458512306213379,0.920634925365448;0,0.466417670249939,0.936507940292358;0,0.474323064088821,0.952380955219269;0,0.482228457927704,0.968253970146179;0,0.490133821964264,0.984126985073090;0,0.498039215803146,1;0,0,0;0.0158730167895556,0,0.00790538452565670;0.0317460335791111,0,0.0158107690513134;0.0476190485060215,0,0.0237161535769701;0.0634920671582222,0,0.0316215381026268;0.0793650820851326,0,0.0395269207656384;0.0952380970120430,0,0.0474323071539402;0.111111111938953,0,0.0553376898169518;0.126984134316444,0,0.0632430762052536;0.142857149243355,0,0.0711484625935555;0.158730164170265,0,0.0790538415312767;0.174603179097176,0,0.0869592279195786;0.190476194024086,0,0.0948646143078804;0.206349208950996,0,0.102769993245602;0.222222223877907,0,0.110675379633904;0.238095238804817,0,0.118580766022205;0.253968268632889,0,0.126486152410507;0.269841283559799,0,0.134391531348228;0.285714298486710,0,0.142296925187111;0.301587313413620,0,0.150202304124832;0.317460328340530,0,0.158107683062553;0.333333343267441,0,0.166013076901436;0.349206358194351,0,0.173918455839157;0.365079373121262,0,0.181823834776878;0.380952388048172,0,0.189729228615761;0.396825402975082,0,0.197634607553482;0.412698417901993,0,0.205539986491203;0.428571432828903,0,0.213445380330086;0.444444447755814,0,0.221350759267807;0.460317462682724,0,0.229256153106689;0.476190477609634,0,0.237161532044411;0.492063492536545,0,0.245066910982132;0.507936537265778,0,0.252972304821014;0.523809552192688,0,0.260877698659897;0.539682567119598,0,0.268783062696457;0.555555582046509,0,0.276688456535339;0.571428596973419,0,0.284593850374222;0.587301611900330,0,0.292499214410782;0.603174626827240,0,0.300404608249664;0.619047641754150,0,0.308310002088547;0.634920656681061,0,0.316215366125107;0.650793671607971,0,0.324120759963989;0.666666686534882,0,0.332026153802872;0.682539701461792,0,0.339931517839432;0.698412716388702,0,0.347836911678314;0.714285731315613,0,0.355742305517197;0.730158746242523,0,0.363647669553757;0.746031761169434,0,0.371553063392639;0.761904776096344,0,0.379458457231522;0.777777791023254,0,0.387363821268082;0.793650805950165,0,0.395269215106964;0.809523820877075,0,0.403174608945847;0.825396835803986,0,0.411079972982407;0.841269850730896,0,0.418985366821289;0.857142865657806,0,0.426890760660172;0.873015880584717,0,0.434796154499054;0.888888895511627,0,0.442701518535614;0.904761910438538,0,0.450606912374496;0.920634925365448,0,0.458512306213379;0.936507940292358,0,0.466417670249939;0.952380955219269,0,0.474323064088821;0.968253970146179,0,0.482228457927704;0.984126985073090,0,0.490133821964264;1,0,0.498039215803146];
    %Take only the number of single-color colormaps from the sequence needed
    %based on the number of tumour regions there are
    colormap(cmap(1:64*(1+max(table.ID)),:));
    %create colorbar label based on the table ID
    cbarlabel = {'Normal Liver'};
    for i = 1 : max(table.ID)
        cbarlabel = [cbarlabel ['Tumour ' int2str(i)]]; %#ok<AGROW>
    end
    
    %create and loop the graphic through each slice
    while ishandle(h)
        
        for i = 1 : size(mat,3);
            %check that figure is open before executing iteration
            if ~ishandle(h)
                break
            end
            
            imagesc(mat(:,:,i)',[0 (1+max(table.ID))*(maxdose+1e-9)]); %(1+max(table.ID)) is num colors in custom colormap
            axis off;
            title(['Slice ' int2str(i) ' of ' int2str(size(mat,3))]);
            colorbar('Ticks', maxdose/2:maxdose:13*maxdose,'TickLabels',cbarlabel);
            pause(0.1);
        end
    end
    
else
    switch attribute
        case {'dose','Dose'}
            x = table2mat(table,'dose');
            ylabel_text = 'Dose (Gy)';
            cmap = jet;
        case {'ID','id'}
            x = table2mat(table,'ID');
            ylabel_text = 'ID';
            table.ID = table.ID + 1;
            cmap = colours;
            cmap = cmap(1:max(table.ID),:);
        case {'BED','bed'}
            x = table2mat(table,'BED');
            ylabel_text = 'BED (Gy)';
            cmap = hot;
        case {'EQD2','eqd2','EQD','eqd'}
            x = table2mat(table,'EQD2');
            ylabel_text = 'EQD2 (Gy)';
            cmap = copper;
        case {'NTCP','ntcp'}
            x = table2mat(table,'NTCP');
            ylabel_text = 'NTCP';
            cmap = red;
        case {'TCP','tcp'}
            x = table2mat(table,'TCP');
            ylabel_text = 'TCP';
            cmap = green;
        otherwise
            error('%s is not a valid attribute', attribute);
    end
    
    %create figure
    h = figure;
    
    %create pause and resume buttons
    %add pause button
    uicontrol(...%'Style','togglebutton',...
        'Position',[10 100 50 50],...
        'String','Pause',...
        'Callback','uiwait(gcbf)');
    %add resume button
    uicontrol('Position',[10 30 50 50],...
        'String','Resume',...
        'Callback','uiresume(gcbf)');
    
    %loop through slices
    while ishandle(h)
        for i = 1 : size(x,3)
            %check that figure is open before executing iteration
            if ~ishandle(h)
                break
            end
            
            %display data
            imagesc(x(:,:,i)',[0 max(x(:))]);
            axis off
            
            %create title
            title(['Slice ' int2str(i) ' of ' int2str(size(x,3))]);
            
            %create colormap
            colormap(cmap)                                            %%%%%%
            c = colorbar;
            
            %create ylabel
            ylabel(c,ylabel_text);
            
            pause(0.05);
        end
    end
end

    function g = green
        g = zeros(64,3);
        g(:,2)=(0:63)'/63;
    end

    function r = red
        r = zeros(64,3);
        r(:,1)=(0:63)'/63;
    end

    function clrs = colours
        clrs = [1,1,1;1,0,0;0,0.5,0;0,0,1;1,1,0;1,0,1;0,1,1;0,1,0];
    end
end
